{"ast":null,"code":"import _classCallCheck from\"C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import*as THREE from'three';import{OBJLoader}from'three/examples/jsm/loaders/OBJLoader.js';import Link from'../Components/BrainConnector.js';import'../styles/Styles.css';import StoreText from\"../Components/StoreText\";import{Vector3}from\"three\";import{BloomEffect,EffectComposer,EffectPass,RenderPass}from\"postprocessing\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ThreeDBrain=/*#__PURE__*/function(_Component){_inherits(ThreeDBrain,_Component);var _super=_createSuper(ThreeDBrain);function ThreeDBrain(props){var _this;_classCallCheck(this,ThreeDBrain);_this=_super.call(this,props);_this.updateScrollPos=function(){//console.log(this.props.userScroll);\nif(_this.props.userScroll>_this.props.thresholds[_this.state.thresholdCounter]){var currThreshold=_this.state.thresholdCounter;//console.log(this.props.thresholds[this.state.thresholdCounter]);\n_this.setState({inThreshold:false,thresholdCounter:currThreshold+1,targetPOV:_this.props.targets[currThreshold+1],raycastXY:_this.props.rays[currThreshold+1],blurbXY:_this.props.blurbCoords[currThreshold+1],currBlurb:_this.props.blurb[currThreshold+1],showLine:false});if(_this.timer){clearTimeout(_this.timer);}if(_this.lightTimer.length!==0){//console.log(this.lightTimer);\nfor(var timeout=0;timeout<_this.lightTimer.length;timeout++){clearTimeout(_this.lightTimer[timeout]);}_this.lightTimer=[];}_this.rayLight.intensity=0;if(_this.state.thresholdCounter%2===1){_this.timer=setTimeout(function(){_this.highlightPoint(_this.state.raycastXY);},800);}_this.setState({drawLine:false});}else if(_this.props.userScroll<_this.props.thresholds[_this.state.thresholdCounter-1]){var _currThreshold=_this.state.thresholdCounter;//console.log(window.scrollY, this.props.thresholds[this.state.thresholdCounter]);\n_this.setState({inThreshold:false,thresholdCounter:_currThreshold-1,targetPOV:_this.props.targets[_currThreshold-1],raycastXY:_this.props.rays[_currThreshold-1],blurbXY:_this.props.blurbCoords[_currThreshold-1],currBlurb:_this.props.blurb[_currThreshold-1],showLine:false});if(_this.timer){clearTimeout(_this.timer);}if(_this.lightTimer.length!==0){//console.log(this.lightTimer);\nfor(var _timeout=0;_timeout<_this.lightTimer.length;_timeout++){clearTimeout(_this.lightTimer[_timeout]);}_this.lightTimer=[];}_this.rayLight.intensity=0;if(_this.state.thresholdCounter%2===1){_this.timer=setTimeout(function(){_this.highlightPoint(_this.state.raycastXY);},800);}_this.setState({drawLine:false});}//console.log(this.props.thresholds[this.state.thresholdCounter])\n};_this.handleWindowResize=function(){_this.setState({width:_this.el.clientWidth,height:_this.el.clientHeight});_this.camera.aspect=_this.state.width/_this.state.height;_this.camera.fov=Math.min(50,360/Math.PI*Math.atan(_this.state.tanFOV*(_this.state.ogWinWidth/_this.state.ogWinHeight)/(_this.el.clientWidth/_this.state.ogWinWidth)));_this.camera.updateProjectionMatrix();_this.renderer.setSize(_this.state.width,_this.state.height);_this.reshapeTex(_this.scene.background,_assertThisInitialized(_this));// console.log(this.props.thresholds);\n};_this.reshapeTex=function(tex,reference){var canvasAspect=reference.camera.aspect;var imageAspect=tex.image?tex.image.width/tex.image.height:1;var aspect=imageAspect/canvasAspect;tex.offset.x=aspect>1?(1-1/aspect)/2:0;tex.repeat.x=aspect>1?1/aspect:1;tex.offset.y=aspect>1?0:(1-aspect)/2;tex.repeat.y=aspect>1?1:aspect;};_this.sceneSetup=function(){// get container dimensions and use them for scene sizing\nvar width=_this.el.clientWidth;var height=_this.el.clientHeight;_this.setState({width:width,height:width});_this.scene=new THREE.Scene();_this.camera=new THREE.PerspectiveCamera(Math.min(50,360/Math.PI*Math.atan(_this.state.tanFOV*(_this.state.ogWinWidth/_this.state.ogWinHeight)/(_this.state.width/_this.state.ogWinWidth))),// fov = field of view\nwidth/height,// aspect ratio\n0.1,// near plane\n10// far plane\n);// default camera position\n_this.camera.z=3;_this.camera.y=1;_this.camera.z=8;_this.renderer=new THREE.WebGLRenderer({powerPreference:\"high-performance\",antialias:false,stencil:false,depth:true});_this.renderer.setSize(width,height);_this.composer=new EffectComposer(_this.renderer);_this.composer.addPass(new RenderPass(_this.scene,_this.camera));_this.el.appendChild(_this.renderer.domElement);// mount using React ref\n//Load background texture\nfunction applyTex(tex,reference){reference.reshapeTex(tex,reference);reference.scene.background=tex;};var loader=new THREE.TextureLoader();loader.load('./assets/background_without_logo.png',function(texture){return applyTex(texture,_assertThisInitialized(_this));});_this.raycaster=new THREE.Raycaster();};_this.populateScene=function(){var light=new THREE.AmbientLight(0x0E62AB,2);light.position.set(0,-4,0);_this.scene.add(light);var light2=new THREE.DirectionalLight(0x5599ff,2);light2.position.set(0,2,0);_this.scene.add(light2);var light3=new THREE.DirectionalLight(0x5599ff,2);light3.position.set(2,0,0);_this.scene.add(light3);_this.rayLight=new THREE.PointLight(0xFFFF00,0,0.2,1.5);_this.rayLight.position.set(0,0,0);_this.scene.add(_this.rayLight);// const raySphereGeo = new THREE.SphereBufferGeometry( 1/20, 16, 16 );\n// const raySphereMat = new THREE.MeshBasicMaterial( { color: 0xffffff } );\n// this.raySphere = new THREE.Mesh(raySphereGeo, raySphereMat);\n// this.raySphere.layers.set( 0 );\n// this.raySphere.position.set(0, 0, 0);\n// this.scene.add( this.raySphere );\n_this.composer.addPass(new EffectPass(_this.camera,new BloomEffect({//camera : this.camera,\n//lightSource : this.rayLight.position\n})));//Load brain object file\nvar loader=new OBJLoader();//Create material for object\nvar testMat=new THREE.MeshLambertMaterial({color:0x5555555//wireframe: true\n//flatShading: false,\n//emissive: 0x3399ff\n});//load Brain into directory\nfunction loadedBrain(brain,scene){brain.traverse(function(node){if(node.isMesh)node.material=testMat;});var scaleFac=0.01;brain.scale.set(scaleFac,scaleFac,scaleFac);brain.rotateY(4.5);brain.position.x=0;brain.position.y=-1;brain.position.z=0;brain.name=\"Brain\";scene.add(brain);}loader.load('./assets/Brain.obj',function(out){return loadedBrain(out,_this.scene);},function(xhr){console.log(xhr.loaded/xhr.total*100+\"% loaded\");},function(error){console.log(\"An error happened\"+error);});//this.composer.addPass(new EffectPass(this.camera, new GodRaysEffect(this.camera, this.raySphere)))\n};_this.startAnimationLoop=function(){// this.cube.rotation.x += 0.01;\n// this.cube.rotation.y += 0.01;\n_this.updateCamera();_this.renderer.render(_this.scene,_this.camera);_this.requestID=window.requestAnimationFrame(_this.startAnimationLoop);};_this.updateCamera=function(){//console.log(this.state.targetPOV);\nvar targetPos=_this.state.targetPOV;;var lookAtCoord=_this.state.lookAtPoint;// Right now this only runs once?\n_this.camera.position.lerp(targetPos,0.08);_this.camera.lookAt(lookAtCoord);};_this.highlightPoint=function(coords){_this.raycaster.setFromCamera(coords,_this.camera);var intersects=_this.raycaster.intersectObjects(_this.scene.children);//console.log(intersects);\nif(intersects.length!==0){var pointVec=intersects[0].point;//.applyMatrix4(this.camera.matrixWorld);\nvar camZVec=new Vector3(0,0,0.10);camZVec.applyQuaternion(_this.camera.quaternion);var vec=pointVec.add(camZVec);//console.log(vec);\n_this.rayLight.position.set(vec.x,Math.floor(vec.y*1000)/1000,vec.z);//this.raySphere.position.set(vec.x, vec.y, vec.z);\n_this.rayLight.intensity=50*Math.sin(1/100);var _loop=function _loop(v){if(_this.rayLight.intensity>0){_this.lightTimer.push(setTimeout(function(){_this.rayLight.intensity=20*Math.sin(v/100);// this.raySphere.scale.set(v/157, v/157, v/157);\n},10*v));}_this.lightTimer.push(setTimeout(function(){_this.setState({drawLine:true});// console.log(this.state.drawLine);\n// console.log(this.state.raycastXY);\n},50));};for(var v=1;v<=157;v++){_loop(v);}}};_this.state={targets:props.targets,targetPOV:props.targets[0],raycasts:props.rays,raycastXY:props.rays[0],blurbCoords:props.blurbCoords,blurbXY:props.blurbCoords[0],blurbs:props.blurb,currBlurb:props.blurb[0],lookAtPoint:new Vector3(0,0,0),height:0,width:0,thresholdCounter:0,animationCalled:false,tanFOV:Math.tan(Math.PI/180*120/2),//55 here is the camera's FOV remember this\nogWinHeight:window.innerHeight,ogWinWidth:window.innerWidth,drawLine:false,inThreshold:false};_this.lightTimer=[];return _this;}_createClass(ThreeDBrain,[{key:\"componentDidMount\",value:function componentDidMount(){this.sceneSetup();this.populateScene();this.startAnimationLoop();window.addEventListener('resize',this.handleWindowResize);window.addEventListener('scroll',this.updateScrollPos);window.addEventListener('load',this.updateScrollPos);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener(\"resize\",this.handleWindowResize);window.removeEventListener('scroll',this.updateScrollPos);window.removeEventListener('load',this.updateScrollPos);window.cancelAnimationFrame(this.requestID);}},{key:\"render\",value://Write event when user scrolls to certain points on the scrollbar. Have certain waypoints that\n//trigger specific camera movements at that point.\nfunction render(){var _this2=this;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"ThreeScene\",ref:function ref(_ref){return _this2.el=_ref;},children:[/*#__PURE__*/_jsx(\"div\",{className:this.state.thresholdCounter%2===0?\"blur-on\":\"blur-off\"}),/*#__PURE__*/_jsx(StoreText,{showClass:this.state.drawLine?\"storeText\":\"storeText-hidden\",title:this.state.currBlurb[0],coords:this.state.blurbXY,elems:this.state.currBlurb[1]}),this.state.drawLine&&/*#__PURE__*/_jsx(Link,{startX:this.state.width*this.state.blurbXY.x/2+this.state.width/2,startY:-(this.el.clientHeight*this.state.blurbXY.y/2-this.el.clientHeight/2),endX:this.state.width*this.state.raycastXY.x/2+this.state.width/2,endY:-(this.el.clientHeight*this.state.raycastXY.y/2-this.el.clientHeight/2)})]})});}}]);return ThreeDBrain;}(Component);// class ThreeScene extends Component {\n//   constructor(props) {\n//     super(props);\n//   }\n//   state = { isMounted: true };\n//   render() {\n//     const { isMounted = true } = this.state;\n//     return (\n//       <>\n//         <button\n//           onClick={() =>\n//             this.setState(state => ({ isMounted: !state.isMounted }))\n//           }\n//         >\n//           {isMounted ? \"Unmount\" : \"Mount\"}\n//         </button>\n//         {isMounted && <LoadBrain userScroll = {this.props.userScroll} targets = {this.props.targets} thresholds = {this.props.thresholds} rays = {this.props.rays} />}\n//         {isMounted && <div>Scroll to zoom, drag to rotate</div>}\n//       </>\n//     );\n//   }\n// }\nexport default ThreeDBrain;","map":{"version":3,"sources":["C:/Users/strie/Documents/GitHub/uwsynaptech-website/synaptech-page/src/Components/Homepage_Background.js"],"names":["React","Component","THREE","OBJLoader","Link","StoreText","Vector3","BloomEffect","EffectComposer","EffectPass","RenderPass","ThreeDBrain","props","updateScrollPos","userScroll","thresholds","state","thresholdCounter","currThreshold","setState","inThreshold","targetPOV","targets","raycastXY","rays","blurbXY","blurbCoords","currBlurb","blurb","showLine","timer","clearTimeout","lightTimer","length","timeout","rayLight","intensity","setTimeout","highlightPoint","drawLine","handleWindowResize","width","el","clientWidth","height","clientHeight","camera","aspect","fov","Math","min","PI","atan","tanFOV","ogWinWidth","ogWinHeight","updateProjectionMatrix","renderer","setSize","reshapeTex","scene","background","tex","reference","canvasAspect","imageAspect","image","offset","x","repeat","y","sceneSetup","Scene","PerspectiveCamera","z","WebGLRenderer","powerPreference","antialias","stencil","depth","composer","addPass","appendChild","domElement","applyTex","loader","TextureLoader","load","texture","raycaster","Raycaster","populateScene","light","AmbientLight","position","set","add","light2","DirectionalLight","light3","PointLight","testMat","MeshLambertMaterial","color","loadedBrain","brain","traverse","node","isMesh","material","scaleFac","scale","rotateY","name","out","xhr","console","log","loaded","total","error","startAnimationLoop","updateCamera","render","requestID","window","requestAnimationFrame","targetPos","lookAtCoord","lookAtPoint","lerp","lookAt","coords","setFromCamera","intersects","intersectObjects","children","pointVec","point","camZVec","applyQuaternion","quaternion","vec","floor","sin","v","push","raycasts","blurbs","animationCalled","tan","innerHeight","innerWidth","addEventListener","removeEventListener","cancelAnimationFrame","ref"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport * as THREE from 'three';\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader.js';\r\nimport Link from '../Components/BrainConnector.js';\r\nimport '../styles/Styles.css';\r\nimport StoreText from \"../Components/StoreText\";\r\nimport { Vector3 } from \"three\";\r\nimport { BloomEffect, EffectComposer, EffectPass, RenderPass } from \"postprocessing\";\r\n\r\nclass ThreeDBrain extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n                targets : props.targets,\r\n                targetPOV : props.targets[0],\r\n                raycasts : props.rays,\r\n                raycastXY : props.rays[0],\r\n                blurbCoords : props.blurbCoords,\r\n                blurbXY : props.blurbCoords[0],\r\n                blurbs : props.blurb,\r\n                currBlurb : props.blurb[0],\r\n                lookAtPoint : (new Vector3(0, 0, 0)),\r\n                height : 0,\r\n                width : 0,\r\n                thresholdCounter : 0,\r\n                animationCalled : false,\r\n                tanFOV : Math.tan( ( ( Math.PI / 180 ) * 120 / 2 ) ), //55 here is the camera's FOV remember this\r\n                ogWinHeight : window.innerHeight,\r\n                ogWinWidth : window.innerWidth,\r\n                drawLine : false,\r\n                inThreshold : false\r\n              };\r\n    this.lightTimer = [];\r\n  };\r\n\r\n  componentDidMount() {\r\n      this.sceneSetup();\r\n      this.populateScene();\r\n      this.startAnimationLoop();\r\n      window.addEventListener('resize', this.handleWindowResize);\r\n      window.addEventListener('scroll', this.updateScrollPos);\r\n      window.addEventListener('load', this.updateScrollPos);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"resize\", this.handleWindowResize);\r\n    window.removeEventListener('scroll', this.updateScrollPos);\r\n    window.removeEventListener('load', this.updateScrollPos);\r\n    window.cancelAnimationFrame(this.requestID);\r\n  }\r\n\r\n  updateScrollPos = () => {\r\n    //console.log(this.props.userScroll);\r\n    if (this.props.userScroll > this.props.thresholds[this.state.thresholdCounter] ) {\r\n      const currThreshold = this.state.thresholdCounter;\r\n      //console.log(this.props.thresholds[this.state.thresholdCounter]);\r\n      this.setState({\r\n        inThreshold : false,\r\n        thresholdCounter : currThreshold + 1,\r\n        targetPOV : this.props.targets[currThreshold + 1],\r\n        raycastXY : this.props.rays[currThreshold + 1],\r\n        blurbXY : this.props.blurbCoords[currThreshold + 1],\r\n        currBlurb : this.props.blurb[currThreshold + 1],\r\n        showLine : false\r\n      });\r\n      if(this.timer) {\r\n        clearTimeout(this.timer);\r\n      }\r\n\r\n      if ( this.lightTimer.length !== 0 ) {\r\n        //console.log(this.lightTimer);\r\n        for ( let timeout = 0; timeout < this.lightTimer.length; timeout++ ) {\r\n          clearTimeout(this.lightTimer[timeout]);\r\n        }\r\n        this.lightTimer = [];\r\n      }\r\n\r\n      this.rayLight.intensity = 0;\r\n      if (this.state.thresholdCounter % 2 === 1) {\r\n        this.timer = setTimeout(() => {this.highlightPoint(this.state.raycastXY)}, 800);\r\n      }\r\n      this.setState({drawLine : false});\r\n\r\n    } else if (this.props.userScroll < this.props.thresholds[this.state.thresholdCounter -1] ) {\r\n      const currThreshold = this.state.thresholdCounter;\r\n      //console.log(window.scrollY, this.props.thresholds[this.state.thresholdCounter]);\r\n      this.setState({\r\n        inThreshold : false,\r\n        thresholdCounter : currThreshold - 1,\r\n        targetPOV : this.props.targets[currThreshold - 1],\r\n        raycastXY : this.props.rays[currThreshold - 1],\r\n        blurbXY : this.props.blurbCoords[currThreshold - 1],\r\n        currBlurb : this.props.blurb[currThreshold - 1],\r\n        showLine : false\r\n      });\r\n      if(this.timer) {\r\n        clearTimeout(this.timer);\r\n      }\r\n      if ( this.lightTimer.length !== 0 ) {\r\n        //console.log(this.lightTimer);\r\n        for ( let timeout = 0; timeout < this.lightTimer.length; timeout++ ) {\r\n          clearTimeout(this.lightTimer[timeout]);\r\n        }\r\n        this.lightTimer = [];\r\n      }\r\n      this.rayLight.intensity = 0;\r\n      if (this.state.thresholdCounter % 2 === 1) {\r\n        this.timer = setTimeout(() => {this.highlightPoint(this.state.raycastXY)}, 800);\r\n      }\r\n      this.setState({drawLine : false});\r\n    }\r\n    //console.log(this.props.thresholds[this.state.thresholdCounter])\r\n  }\r\n\r\n  handleWindowResize = () => {\r\n    this.setState({\r\n      width : this.el.clientWidth,\r\n      height : this.el.clientHeight\r\n    });\r\n    this.camera.aspect = this.state.width / this.state.height;\r\n    this.camera.fov = Math.min(50, ( 360 / Math.PI ) * Math.atan( this.state.tanFOV * ( this.state.ogWinWidth / this.state.ogWinHeight ) / ( this.el.clientWidth / this.state.ogWinWidth )));\r\n    this.camera.updateProjectionMatrix();\r\n    this.renderer.setSize( this.state.width, this.state.height );\r\n    this.reshapeTex(this.scene.background, this);\r\n    // console.log(this.props.thresholds);\r\n  };\r\n\r\n  reshapeTex = (tex, reference) => {\r\n    const canvasAspect = reference.camera.aspect;\r\n    const imageAspect = tex.image ? tex.image.width / tex.image.height : 1;\r\n    const aspect = imageAspect / canvasAspect;\r\n\r\n    tex.offset.x = aspect > 1 ? (1 - 1 / aspect) / 2 : 0;\r\n    tex.repeat.x = aspect > 1 ? 1 / aspect : 1;\r\n\r\n    tex.offset.y = aspect > 1 ? 0 : (1 - aspect) / 2;\r\n    tex.repeat.y = aspect > 1 ? 1 : aspect;\r\n  }\r\n\r\n  sceneSetup = () => {\r\n    // get container dimensions and use them for scene sizing\r\n    const width = this.el.clientWidth;\r\n    const height = this.el.clientHeight;\r\n    this.setState({\r\n      width : width,\r\n      height : width\r\n    });\r\n    this.scene = new THREE.Scene();\r\n    this.camera = new THREE.PerspectiveCamera(\r\n        Math.min(50, ( 360 / Math.PI ) * Math.atan( this.state.tanFOV * ( this.state.ogWinWidth / this.state.ogWinHeight ) / ( this.state.width / this.state.ogWinWidth ))), // fov = field of view\r\n        width / height, // aspect ratio\r\n        0.1, // near plane\r\n        10 // far plane\r\n    );\r\n\r\n    // default camera position\r\n\r\n    this.camera.z = 3;\r\n    this.camera.y = 1;\r\n    this.camera.z = 8;\r\n    this.renderer = new THREE.WebGLRenderer({\r\n      powerPreference: \"high-performance\",\r\n      antialias: false,\r\n      stencil: false,\r\n      depth: true\r\n      });\r\n    this.renderer.setSize( width, height );\r\n    this.composer = new EffectComposer(this.renderer);\r\n    this.composer.addPass(new RenderPass(this.scene, this.camera));\r\n    this.el.appendChild( this.renderer.domElement ); // mount using React ref\r\n\r\n    //Load background texture\r\n    function applyTex(tex, reference) {\r\n      reference.reshapeTex(tex, reference);\r\n      reference.scene.background = tex;\r\n    };\r\n\r\n    const loader = new THREE.TextureLoader();\r\n    loader.load('./assets/background_without_logo.png' ,\r\n    (texture) => applyTex(texture, this));\r\n    this.raycaster = new THREE.Raycaster();\r\n  };\r\n\r\n\r\n  populateScene  = () => {\r\n    const light = new THREE.AmbientLight(0x0E62AB, 2);\r\n    light.position.set(0, -4, 0);\r\n    this.scene.add(light);\r\n    const light2 = new THREE.DirectionalLight(0x5599ff, 2);\r\n    light2.position.set(0, 2, 0);\r\n    this.scene.add(light2);\r\n    const light3 = new THREE.DirectionalLight(0x5599ff, 2);\r\n    light3.position.set(2, 0, 0);\r\n    this.scene.add(light3);\r\n    this.rayLight = new THREE.PointLight(0xFFFF00, 0, 0.2, 1.5);\r\n    this.rayLight.position.set(0, 0, 0);\r\n    this.scene.add(this.rayLight);\r\n\r\n    // const raySphereGeo = new THREE.SphereBufferGeometry( 1/20, 16, 16 );\r\n    // const raySphereMat = new THREE.MeshBasicMaterial( { color: 0xffffff } );\r\n    // this.raySphere = new THREE.Mesh(raySphereGeo, raySphereMat);\r\n    // this.raySphere.layers.set( 0 );\r\n    // this.raySphere.position.set(0, 0, 0);\r\n    // this.scene.add( this.raySphere );\r\n    this.composer.addPass(new EffectPass(this.camera, new BloomEffect({\r\n      //camera : this.camera,\r\n      //lightSource : this.rayLight.position\r\n    })));\r\n\r\n    //Load brain object file\r\n    var loader = new OBJLoader();\r\n\r\n    //Create material for object\r\n    const testMat = new THREE.MeshLambertMaterial({\r\n      color: 0x5555555,\r\n      //wireframe: true\r\n      //flatShading: false,\r\n      //emissive: 0x3399ff\r\n      });\r\n\r\n    //load Brain into directory\r\n    function loadedBrain( brain, scene) {\r\n      brain.traverse((node) => {\r\n        if(node.isMesh) node.material = testMat;\r\n      });\r\n      const scaleFac = 0.01;\r\n      brain.scale.set(scaleFac, scaleFac, scaleFac);\r\n      brain.rotateY(4.5)\r\n      brain.position.x = 0;\r\n      brain.position.y = -1;\r\n      brain.position.z = 0;\r\n      brain.name = \"Brain\"\r\n      scene.add(brain);\r\n    }\r\n    loader.load('./assets/Brain.obj',\r\n      (out) => loadedBrain( out, this.scene ),\r\n      function(xhr) {\r\n        console.log((xhr.loaded / xhr.total) * 100 + \"% loaded\");\r\n      },\r\n      function(error) {\r\n        console.log(\"An error happened\" + error);\r\n      }\r\n    );\r\n    //this.composer.addPass(new EffectPass(this.camera, new GodRaysEffect(this.camera, this.raySphere)))\r\n  };\r\n\r\n\r\n  startAnimationLoop = () => {\r\n    // this.cube.rotation.x += 0.01;\r\n    // this.cube.rotation.y += 0.01;\r\n    this.updateCamera();\r\n    this.renderer.render( this.scene, this.camera );\r\n    this.requestID = window.requestAnimationFrame(this.startAnimationLoop);\r\n  };\r\n\r\n  updateCamera = () => {\r\n    //console.log(this.state.targetPOV);\r\n    const targetPos = this.state.targetPOV;;\r\n    const lookAtCoord = this.state.lookAtPoint;\r\n\r\n    // Right now this only runs once?\r\n    this.camera.position.lerp(targetPos, 0.08);\r\n    this.camera.lookAt(lookAtCoord);\r\n  }\r\n\r\n  highlightPoint = (coords) => {\r\n    this.raycaster.setFromCamera(coords,  this.camera);\r\n    var intersects = this.raycaster.intersectObjects(this.scene.children);\r\n    //console.log(intersects);\r\n    if (intersects.length !== 0) {\r\n      const pointVec = intersects[0].point//.applyMatrix4(this.camera.matrixWorld);\r\n      const camZVec = (new Vector3(0, 0, 0.10));\r\n      camZVec.applyQuaternion(this.camera.quaternion);\r\n      const vec = pointVec.add(camZVec);\r\n      //console.log(vec);\r\n      this.rayLight.position.set(vec.x, Math.floor(vec.y*1000)/1000, vec.z);\r\n      //this.raySphere.position.set(vec.x, vec.y, vec.z);\r\n      this.rayLight.intensity = 50*Math.sin(1/100);\r\n      for( let v = 1; v <= 157; v++ ) {\r\n        if (this.rayLight.intensity > 0) {\r\n          this.lightTimer.push(setTimeout(() => {\r\n            this.rayLight.intensity = ((20)*Math.sin(v/100));\r\n            // this.raySphere.scale.set(v/157, v/157, v/157);\r\n          }, (10*v)));\r\n        }\r\n        this.lightTimer.push(setTimeout(() => {\r\n          this.setState({drawLine : true})\r\n          // console.log(this.state.drawLine);\r\n          // console.log(this.state.raycastXY);\r\n        }, (50)));\r\n      }\r\n    }\r\n  }\r\n  //Write event when user scrolls to certain points on the scrollbar. Have certain waypoints that\r\n  //trigger specific camera movements at that point.\r\n\r\n  render() {\r\n      return(\r\n        <>\r\n          <div className = \"ThreeScene\" ref={ref => (this.el = ref)}>\r\n            <div className = {(this.state.thresholdCounter %2 === 0 ) ? \"blur-on\" : \"blur-off\"}>\r\n            </div>\r\n          {\r\n            <StoreText showClass = {\r\n              (this.state.drawLine) ? \"storeText\" : \"storeText-hidden\"\r\n            } title={this.state.currBlurb[0]} coords = {this.state.blurbXY} elems={this.state.currBlurb[1]}></StoreText>\r\n          }\r\n          { ( this.state.drawLine ) && <Link\r\n            startX = { (this.state.width*this.state.blurbXY.x)/2 + this.state.width/2 }\r\n            startY = { -((this.el.clientHeight*this.state.blurbXY.y/2) - this.el.clientHeight/2) }\r\n            endX = { (this.state.width*this.state.raycastXY.x)/2 + this.state.width/2 }\r\n            endY = { -((this.el.clientHeight*this.state.raycastXY.y/2) - this.el.clientHeight/2) }\r\n          /> }\r\n          </div>\r\n        </>\r\n      );\r\n  }\r\n}\r\n\r\n// class ThreeScene extends Component {\r\n\r\n//   constructor(props) {\r\n//     super(props);\r\n//   }\r\n\r\n//   state = { isMounted: true };\r\n//   render() {\r\n//     const { isMounted = true } = this.state;\r\n//     return (\r\n//       <>\r\n//         <button\r\n//           onClick={() =>\r\n//             this.setState(state => ({ isMounted: !state.isMounted }))\r\n//           }\r\n//         >\r\n//           {isMounted ? \"Unmount\" : \"Mount\"}\r\n//         </button>\r\n//         {isMounted && <LoadBrain userScroll = {this.props.userScroll} targets = {this.props.targets} thresholds = {this.props.thresholds} rays = {this.props.rays} />}\r\n//         {isMounted && <div>Scroll to zoom, drag to rotate</div>}\r\n//       </>\r\n//     );\r\n//   }\r\n// }\r\n\r\nexport default ThreeDBrain;"]},"metadata":{},"sourceType":"module"}